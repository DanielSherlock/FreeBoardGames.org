{"ast":null,"code":"function cov_j6hb4vjqv() {\n  var path = \"/home/j/Documents/FreeBoardGames.org/src/games/seabattle/ai.ts\";\n  var hash = \"7290addc126aa92d130533cfc11256b3d86b0931\";\n  var global = new Function(\"return this\")();\n  var gcv = \"__coverage__\";\n  var coverageData = {\n    path: \"/home/j/Documents/FreeBoardGames.org/src/games/seabattle/ai.ts\",\n    statementMap: {\n      \"0\": {\n        start: {\n          line: 19,\n          column: 4\n        },\n        end: {\n          line: 28,\n          column: 5\n        }\n      },\n      \"1\": {\n        start: {\n          line: 20,\n          column: 28\n        },\n        end: {\n          line: 20,\n          column: 82\n        }\n      },\n      \"2\": {\n        start: {\n          line: 21,\n          column: 6\n        },\n        end: {\n          line: 21,\n          column: 60\n        }\n      },\n      \"3\": {\n        start: {\n          line: 24,\n          column: 22\n        },\n        end: {\n          line: 24,\n          column: 62\n        }\n      },\n      \"4\": {\n        start: {\n          line: 25,\n          column: 6\n        },\n        end: {\n          line: 25,\n          column: 27\n        }\n      },\n      \"5\": {\n        start: {\n          line: 26,\n          column: 19\n        },\n        end: {\n          line: 26,\n          column: 53\n        }\n      },\n      \"6\": {\n        start: {\n          line: 27,\n          column: 6\n        },\n        end: {\n          line: 27,\n          column: 48\n        }\n      },\n      \"7\": {\n        start: {\n          line: 32,\n          column: 4\n        },\n        end: {\n          line: 32,\n          column: 101\n        }\n      },\n      \"8\": {\n        start: {\n          line: 36,\n          column: 4\n        },\n        end: {\n          line: 36,\n          column: 107\n        }\n      },\n      \"9\": {\n        start: {\n          line: 40,\n          column: 19\n        },\n        end: {\n          line: 43,\n          column: 5\n        }\n      },\n      \"10\": {\n        start: {\n          line: 42,\n          column: 8\n        },\n        end: {\n          line: 42,\n          column: 103\n        }\n      },\n      \"11\": {\n        start: {\n          line: 44,\n          column: 4\n        },\n        end: {\n          line: 55,\n          column: 5\n        }\n      },\n      \"12\": {\n        start: {\n          line: 46,\n          column: 6\n        },\n        end: {\n          line: 54,\n          column: 7\n        }\n      },\n      \"13\": {\n        start: {\n          line: 47,\n          column: 31\n        },\n        end: {\n          line: 47,\n          column: 79\n        }\n      },\n      \"14\": {\n        start: {\n          line: 48,\n          column: 8\n        },\n        end: {\n          line: 51,\n          column: 9\n        }\n      },\n      \"15\": {\n        start: {\n          line: 50,\n          column: 10\n        },\n        end: {\n          line: 50,\n          column: 66\n        }\n      },\n      \"16\": {\n        start: {\n          line: 53,\n          column: 8\n        },\n        end: {\n          line: 53,\n          column: 52\n        }\n      },\n      \"17\": {\n        start: {\n          line: 57,\n          column: 4\n        },\n        end: {\n          line: 57,\n          column: 42\n        }\n      },\n      \"18\": {\n        start: {\n          line: 61,\n          column: 17\n        },\n        end: {\n          line: 61,\n          column: 55\n        }\n      },\n      \"19\": {\n        start: {\n          line: 61,\n          column: 42\n        },\n        end: {\n          line: 61,\n          column: 54\n        }\n      },\n      \"20\": {\n        start: {\n          line: 62,\n          column: 17\n        },\n        end: {\n          line: 62,\n          column: 55\n        }\n      },\n      \"21\": {\n        start: {\n          line: 62,\n          column: 42\n        },\n        end: {\n          line: 62,\n          column: 54\n        }\n      },\n      \"22\": {\n        start: {\n          line: 64,\n          column: 19\n        },\n        end: {\n          line: 64,\n          column: 65\n        }\n      },\n      \"23\": {\n        start: {\n          line: 65,\n          column: 19\n        },\n        end: {\n          line: 65,\n          column: 65\n        }\n      },\n      \"24\": {\n        start: {\n          line: 66,\n          column: 22\n        },\n        end: {\n          line: 66,\n          column: 77\n        }\n      },\n      \"25\": {\n        start: {\n          line: 67,\n          column: 4\n        },\n        end: {\n          line: 70,\n          column: 7\n        }\n      },\n      \"26\": {\n        start: {\n          line: 74,\n          column: 4\n        },\n        end: {\n          line: 74,\n          column: 28\n        }\n      },\n      \"27\": {\n        start: {\n          line: 78,\n          column: 4\n        },\n        end: {\n          line: 78,\n          column: 96\n        }\n      },\n      \"28\": {\n        start: {\n          line: 82,\n          column: 4\n        },\n        end: {\n          line: 82,\n          column: 19\n        }\n      },\n      \"29\": {\n        start: {\n          line: 83,\n          column: 4\n        },\n        end: {\n          line: 87,\n          column: 5\n        }\n      },\n      \"30\": {\n        start: {\n          line: 84,\n          column: 6\n        },\n        end: {\n          line: 86,\n          column: 7\n        }\n      },\n      \"31\": {\n        start: {\n          line: 85,\n          column: 8\n        },\n        end: {\n          line: 85,\n          column: 20\n        }\n      },\n      \"32\": {\n        start: {\n          line: 88,\n          column: 4\n        },\n        end: {\n          line: 88,\n          column: 16\n        }\n      },\n      \"33\": {\n        start: {\n          line: 92,\n          column: 4\n        },\n        end: {\n          line: 97,\n          column: 7\n        }\n      },\n      \"34\": {\n        start: {\n          line: 101,\n          column: 4\n        },\n        end: {\n          line: 101,\n          column: 74\n        }\n      },\n      \"35\": {\n        start: {\n          line: 101,\n          column: 52\n        },\n        end: {\n          line: 101,\n          column: 72\n        }\n      },\n      \"36\": {\n        start: {\n          line: 105,\n          column: 4\n        },\n        end: {\n          line: 105,\n          column: 73\n        }\n      },\n      \"37\": {\n        start: {\n          line: 105,\n          column: 49\n        },\n        end: {\n          line: 105,\n          column: 63\n        }\n      },\n      \"38\": {\n        start: {\n          line: 109,\n          column: 38\n        },\n        end: {\n          line: 109,\n          column: 40\n        }\n      },\n      \"39\": {\n        start: {\n          line: 110,\n          column: 4\n        },\n        end: {\n          line: 114,\n          column: 5\n        }\n      },\n      \"40\": {\n        start: {\n          line: 110,\n          column: 17\n        },\n        end: {\n          line: 110,\n          column: 18\n        }\n      },\n      \"41\": {\n        start: {\n          line: 111,\n          column: 6\n        },\n        end: {\n          line: 113,\n          column: 7\n        }\n      },\n      \"42\": {\n        start: {\n          line: 111,\n          column: 19\n        },\n        end: {\n          line: 111,\n          column: 20\n        }\n      },\n      \"43\": {\n        start: {\n          line: 112,\n          column: 8\n        },\n        end: {\n          line: 112,\n          column: 40\n        }\n      },\n      \"44\": {\n        start: {\n          line: 115,\n          column: 4\n        },\n        end: {\n          line: 115,\n          column: 54\n        }\n      },\n      \"45\": {\n        start: {\n          line: 119,\n          column: 18\n        },\n        end: {\n          line: 122,\n          column: 5\n        }\n      },\n      \"46\": {\n        start: {\n          line: 121,\n          column: 8\n        },\n        end: {\n          line: 121,\n          column: 112\n        }\n      },\n      \"47\": {\n        start: {\n          line: 123,\n          column: 4\n        },\n        end: {\n          line: 123,\n          column: 30\n        }\n      },\n      \"48\": {\n        start: {\n          line: 127,\n          column: 33\n        },\n        end: {\n          line: 133,\n          column: 1\n        }\n      },\n      \"49\": {\n        start: {\n          line: 129,\n          column: 4\n        },\n        end: {\n          line: 131,\n          column: 6\n        }\n      },\n      \"50\": {\n        start: {\n          line: 136,\n          column: 2\n        },\n        end: {\n          line: 138,\n          column: 5\n        }\n      },\n      \"51\": {\n        start: {\n          line: 137,\n          column: 4\n        },\n        end: {\n          line: 137,\n          column: 38\n        }\n      }\n    },\n    fnMap: {\n      \"0\": {\n        name: \"(anonymous_0)\",\n        decl: {\n          start: {\n            line: 18,\n            column: 2\n          },\n          end: {\n            line: 18,\n            column: 3\n          }\n        },\n        loc: {\n          start: {\n            line: 18,\n            column: 50\n          },\n          end: {\n            line: 29,\n            column: 3\n          }\n        },\n        line: 18\n      },\n      \"1\": {\n        name: \"(anonymous_1)\",\n        decl: {\n          start: {\n            line: 31,\n            column: 2\n          },\n          end: {\n            line: 31,\n            column: 3\n          }\n        },\n        loc: {\n          start: {\n            line: 31,\n            column: 53\n          },\n          end: {\n            line: 33,\n            column: 3\n          }\n        },\n        line: 31\n      },\n      \"2\": {\n        name: \"(anonymous_2)\",\n        decl: {\n          start: {\n            line: 35,\n            column: 2\n          },\n          end: {\n            line: 35,\n            column: 3\n          }\n        },\n        loc: {\n          start: {\n            line: 35,\n            column: 47\n          },\n          end: {\n            line: 37,\n            column: 3\n          }\n        },\n        line: 35\n      },\n      \"3\": {\n        name: \"(anonymous_3)\",\n        decl: {\n          start: {\n            line: 39,\n            column: 2\n          },\n          end: {\n            line: 39,\n            column: 3\n          }\n        },\n        loc: {\n          start: {\n            line: 39,\n            column: 52\n          },\n          end: {\n            line: 58,\n            column: 3\n          }\n        },\n        line: 39\n      },\n      \"4\": {\n        name: \"(anonymous_4)\",\n        decl: {\n          start: {\n            line: 41,\n            column: 6\n          },\n          end: {\n            line: 41,\n            column: 7\n          }\n        },\n        loc: {\n          start: {\n            line: 42,\n            column: 8\n          },\n          end: {\n            line: 42,\n            column: 103\n          }\n        },\n        line: 42\n      },\n      \"5\": {\n        name: \"(anonymous_5)\",\n        decl: {\n          start: {\n            line: 60,\n            column: 2\n          },\n          end: {\n            line: 60,\n            column: 3\n          }\n        },\n        loc: {\n          start: {\n            line: 60,\n            column: 70\n          },\n          end: {\n            line: 71,\n            column: 3\n          }\n        },\n        line: 60\n      },\n      \"6\": {\n        name: \"(anonymous_6)\",\n        decl: {\n          start: {\n            line: 61,\n            column: 31\n          },\n          end: {\n            line: 61,\n            column: 32\n          }\n        },\n        loc: {\n          start: {\n            line: 61,\n            column: 42\n          },\n          end: {\n            line: 61,\n            column: 54\n          }\n        },\n        line: 61\n      },\n      \"7\": {\n        name: \"(anonymous_7)\",\n        decl: {\n          start: {\n            line: 62,\n            column: 31\n          },\n          end: {\n            line: 62,\n            column: 32\n          }\n        },\n        loc: {\n          start: {\n            line: 62,\n            column: 42\n          },\n          end: {\n            line: 62,\n            column: 54\n          }\n        },\n        line: 62\n      },\n      \"8\": {\n        name: \"(anonymous_8)\",\n        decl: {\n          start: {\n            line: 73,\n            column: 2\n          },\n          end: {\n            line: 73,\n            column: 3\n          }\n        },\n        loc: {\n          start: {\n            line: 73,\n            column: 24\n          },\n          end: {\n            line: 75,\n            column: 3\n          }\n        },\n        line: 73\n      },\n      \"9\": {\n        name: \"(anonymous_9)\",\n        decl: {\n          start: {\n            line: 77,\n            column: 2\n          },\n          end: {\n            line: 77,\n            column: 3\n          }\n        },\n        loc: {\n          start: {\n            line: 77,\n            column: 46\n          },\n          end: {\n            line: 79,\n            column: 3\n          }\n        },\n        line: 77\n      },\n      \"10\": {\n        name: \"(anonymous_10)\",\n        decl: {\n          start: {\n            line: 81,\n            column: 2\n          },\n          end: {\n            line: 81,\n            column: 3\n          }\n        },\n        loc: {\n          start: {\n            line: 81,\n            column: 50\n          },\n          end: {\n            line: 89,\n            column: 3\n          }\n        },\n        line: 81\n      },\n      \"11\": {\n        name: \"(anonymous_11)\",\n        decl: {\n          start: {\n            line: 91,\n            column: 2\n          },\n          end: {\n            line: 91,\n            column: 3\n          }\n        },\n        loc: {\n          start: {\n            line: 91,\n            column: 61\n          },\n          end: {\n            line: 98,\n            column: 3\n          }\n        },\n        line: 91\n      },\n      \"12\": {\n        name: \"(anonymous_12)\",\n        decl: {\n          start: {\n            line: 100,\n            column: 2\n          },\n          end: {\n            line: 100,\n            column: 3\n          }\n        },\n        loc: {\n          start: {\n            line: 100,\n            column: 55\n          },\n          end: {\n            line: 102,\n            column: 3\n          }\n        },\n        line: 100\n      },\n      \"13\": {\n        name: \"(anonymous_13)\",\n        decl: {\n          start: {\n            line: 101,\n            column: 33\n          },\n          end: {\n            line: 101,\n            column: 34\n          }\n        },\n        loc: {\n          start: {\n            line: 101,\n            column: 52\n          },\n          end: {\n            line: 101,\n            column: 72\n          }\n        },\n        line: 101\n      },\n      \"14\": {\n        name: \"(anonymous_14)\",\n        decl: {\n          start: {\n            line: 104,\n            column: 2\n          },\n          end: {\n            line: 104,\n            column: 3\n          }\n        },\n        loc: {\n          start: {\n            line: 104,\n            column: 44\n          },\n          end: {\n            line: 106,\n            column: 3\n          }\n        },\n        line: 104\n      },\n      \"15\": {\n        name: \"(anonymous_15)\",\n        decl: {\n          start: {\n            line: 105,\n            column: 32\n          },\n          end: {\n            line: 105,\n            column: 33\n          }\n        },\n        loc: {\n          start: {\n            line: 105,\n            column: 49\n          },\n          end: {\n            line: 105,\n            column: 63\n          }\n        },\n        line: 105\n      },\n      \"16\": {\n        name: \"(anonymous_16)\",\n        decl: {\n          start: {\n            line: 108,\n            column: 2\n          },\n          end: {\n            line: 108,\n            column: 3\n          }\n        },\n        loc: {\n          start: {\n            line: 108,\n            column: 40\n          },\n          end: {\n            line: 116,\n            column: 3\n          }\n        },\n        line: 108\n      },\n      \"17\": {\n        name: \"(anonymous_17)\",\n        decl: {\n          start: {\n            line: 118,\n            column: 2\n          },\n          end: {\n            line: 118,\n            column: 3\n          }\n        },\n        loc: {\n          start: {\n            line: 118,\n            column: 47\n          },\n          end: {\n            line: 124,\n            column: 3\n          }\n        },\n        line: 118\n      },\n      \"18\": {\n        name: \"(anonymous_18)\",\n        decl: {\n          start: {\n            line: 120,\n            column: 6\n          },\n          end: {\n            line: 120,\n            column: 7\n          }\n        },\n        loc: {\n          start: {\n            line: 121,\n            column: 8\n          },\n          end: {\n            line: 121,\n            column: 112\n          }\n        },\n        line: 121\n      },\n      \"19\": {\n        name: \"(anonymous_19)\",\n        decl: {\n          start: {\n            line: 128,\n            column: 10\n          },\n          end: {\n            line: 128,\n            column: 11\n          }\n        },\n        loc: {\n          start: {\n            line: 128,\n            column: 16\n          },\n          end: {\n            line: 132,\n            column: 3\n          }\n        },\n        line: 128\n      },\n      \"20\": {\n        name: \"sleep\",\n        decl: {\n          start: {\n            line: 135,\n            column: 9\n          },\n          end: {\n            line: 135,\n            column: 14\n          }\n        },\n        loc: {\n          start: {\n            line: 135,\n            column: 37\n          },\n          end: {\n            line: 139,\n            column: 1\n          }\n        },\n        line: 135\n      },\n      \"21\": {\n        name: \"(anonymous_21)\",\n        decl: {\n          start: {\n            line: 136,\n            column: 21\n          },\n          end: {\n            line: 136,\n            column: 22\n          }\n        },\n        loc: {\n          start: {\n            line: 136,\n            column: 34\n          },\n          end: {\n            line: 138,\n            column: 3\n          }\n        },\n        line: 136\n      }\n    },\n    branchMap: {\n      \"0\": {\n        loc: {\n          start: {\n            line: 19,\n            column: 4\n          },\n          end: {\n            line: 28,\n            column: 5\n          }\n        },\n        type: \"if\",\n        locations: [{\n          start: {\n            line: 19,\n            column: 4\n          },\n          end: {\n            line: 28,\n            column: 5\n          }\n        }, {\n          start: {\n            line: 19,\n            column: 4\n          },\n          end: {\n            line: 28,\n            column: 5\n          }\n        }],\n        line: 19\n      },\n      \"1\": {\n        loc: {\n          start: {\n            line: 24,\n            column: 22\n          },\n          end: {\n            line: 24,\n            column: 62\n          }\n        },\n        type: \"cond-expr\",\n        locations: [{\n          start: {\n            line: 24,\n            column: 52\n          },\n          end: {\n            line: 24,\n            column: 55\n          }\n        }, {\n          start: {\n            line: 24,\n            column: 58\n          },\n          end: {\n            line: 24,\n            column: 62\n          }\n        }],\n        line: 24\n      },\n      \"2\": {\n        loc: {\n          start: {\n            line: 42,\n            column: 8\n          },\n          end: {\n            line: 42,\n            column: 103\n          }\n        },\n        type: \"binary-expr\",\n        locations: [{\n          start: {\n            line: 42,\n            column: 8\n          },\n          end: {\n            line: 42,\n            column: 41\n          }\n        }, {\n          start: {\n            line: 42,\n            column: 45\n          },\n          end: {\n            line: 42,\n            column: 63\n          }\n        }, {\n          start: {\n            line: 42,\n            column: 67\n          },\n          end: {\n            line: 42,\n            column: 103\n          }\n        }],\n        line: 42\n      },\n      \"3\": {\n        loc: {\n          start: {\n            line: 46,\n            column: 6\n          },\n          end: {\n            line: 54,\n            column: 7\n          }\n        },\n        type: \"if\",\n        locations: [{\n          start: {\n            line: 46,\n            column: 6\n          },\n          end: {\n            line: 54,\n            column: 7\n          }\n        }, {\n          start: {\n            line: 46,\n            column: 6\n          },\n          end: {\n            line: 54,\n            column: 7\n          }\n        }],\n        line: 46\n      },\n      \"4\": {\n        loc: {\n          start: {\n            line: 48,\n            column: 8\n          },\n          end: {\n            line: 51,\n            column: 9\n          }\n        },\n        type: \"if\",\n        locations: [{\n          start: {\n            line: 48,\n            column: 8\n          },\n          end: {\n            line: 51,\n            column: 9\n          }\n        }, {\n          start: {\n            line: 48,\n            column: 8\n          },\n          end: {\n            line: 51,\n            column: 9\n          }\n        }],\n        line: 48\n      },\n      \"5\": {\n        loc: {\n          start: {\n            line: 66,\n            column: 22\n          },\n          end: {\n            line: 66,\n            column: 77\n          }\n        },\n        type: \"cond-expr\",\n        locations: [{\n          start: {\n            line: 66,\n            column: 46\n          },\n          end: {\n            line: 66,\n            column: 60\n          }\n        }, {\n          start: {\n            line: 66,\n            column: 63\n          },\n          end: {\n            line: 66,\n            column: 77\n          }\n        }],\n        line: 66\n      },\n      \"6\": {\n        loc: {\n          start: {\n            line: 74,\n            column: 11\n          },\n          end: {\n            line: 74,\n            column: 27\n          }\n        },\n        type: \"binary-expr\",\n        locations: [{\n          start: {\n            line: 74,\n            column: 11\n          },\n          end: {\n            line: 74,\n            column: 17\n          }\n        }, {\n          start: {\n            line: 74,\n            column: 21\n          },\n          end: {\n            line: 74,\n            column: 27\n          }\n        }],\n        line: 74\n      },\n      \"7\": {\n        loc: {\n          start: {\n            line: 78,\n            column: 11\n          },\n          end: {\n            line: 78,\n            column: 95\n          }\n        },\n        type: \"binary-expr\",\n        locations: [{\n          start: {\n            line: 78,\n            column: 11\n          },\n          end: {\n            line: 78,\n            column: 34\n          }\n        }, {\n          start: {\n            line: 78,\n            column: 38\n          },\n          end: {\n            line: 78,\n            column: 61\n          }\n        }, {\n          start: {\n            line: 78,\n            column: 65\n          },\n          end: {\n            line: 78,\n            column: 95\n          }\n        }],\n        line: 78\n      },\n      \"8\": {\n        loc: {\n          start: {\n            line: 84,\n            column: 6\n          },\n          end: {\n            line: 86,\n            column: 7\n          }\n        },\n        type: \"if\",\n        locations: [{\n          start: {\n            line: 84,\n            column: 6\n          },\n          end: {\n            line: 86,\n            column: 7\n          }\n        }, {\n          start: {\n            line: 84,\n            column: 6\n          },\n          end: {\n            line: 86,\n            column: 7\n          }\n        }],\n        line: 84\n      },\n      \"9\": {\n        loc: {\n          start: {\n            line: 121,\n            column: 8\n          },\n          end: {\n            line: 121,\n            column: 112\n          }\n        },\n        type: \"binary-expr\",\n        locations: [{\n          start: {\n            line: 121,\n            column: 8\n          },\n          end: {\n            line: 121,\n            column: 58\n          }\n        }, {\n          start: {\n            line: 121,\n            column: 62\n          },\n          end: {\n            line: 121,\n            column: 85\n          }\n        }, {\n          start: {\n            line: 121,\n            column: 89\n          },\n          end: {\n            line: 121,\n            column: 112\n          }\n        }],\n        line: 121\n      }\n    },\n    s: {\n      \"0\": 0,\n      \"1\": 0,\n      \"2\": 0,\n      \"3\": 0,\n      \"4\": 0,\n      \"5\": 0,\n      \"6\": 0,\n      \"7\": 0,\n      \"8\": 0,\n      \"9\": 0,\n      \"10\": 0,\n      \"11\": 0,\n      \"12\": 0,\n      \"13\": 0,\n      \"14\": 0,\n      \"15\": 0,\n      \"16\": 0,\n      \"17\": 0,\n      \"18\": 0,\n      \"19\": 0,\n      \"20\": 0,\n      \"21\": 0,\n      \"22\": 0,\n      \"23\": 0,\n      \"24\": 0,\n      \"25\": 0,\n      \"26\": 0,\n      \"27\": 0,\n      \"28\": 0,\n      \"29\": 0,\n      \"30\": 0,\n      \"31\": 0,\n      \"32\": 0,\n      \"33\": 0,\n      \"34\": 0,\n      \"35\": 0,\n      \"36\": 0,\n      \"37\": 0,\n      \"38\": 0,\n      \"39\": 0,\n      \"40\": 0,\n      \"41\": 0,\n      \"42\": 0,\n      \"43\": 0,\n      \"44\": 0,\n      \"45\": 0,\n      \"46\": 0,\n      \"47\": 0,\n      \"48\": 0,\n      \"49\": 0,\n      \"50\": 0,\n      \"51\": 0\n    },\n    f: {\n      \"0\": 0,\n      \"1\": 0,\n      \"2\": 0,\n      \"3\": 0,\n      \"4\": 0,\n      \"5\": 0,\n      \"6\": 0,\n      \"7\": 0,\n      \"8\": 0,\n      \"9\": 0,\n      \"10\": 0,\n      \"11\": 0,\n      \"12\": 0,\n      \"13\": 0,\n      \"14\": 0,\n      \"15\": 0,\n      \"16\": 0,\n      \"17\": 0,\n      \"18\": 0,\n      \"19\": 0,\n      \"20\": 0,\n      \"21\": 0\n    },\n    b: {\n      \"0\": [0, 0],\n      \"1\": [0, 0],\n      \"2\": [0, 0, 0],\n      \"3\": [0, 0],\n      \"4\": [0, 0],\n      \"5\": [0, 0],\n      \"6\": [0, 0],\n      \"7\": [0, 0, 0],\n      \"8\": [0, 0],\n      \"9\": [0, 0, 0]\n    },\n    _coverageSchema: \"1a1c01bbd47fc00a2c39e90264f33305004495a9\",\n    hash: \"7290addc126aa92d130533cfc11256b3d86b0931\"\n  };\n  var coverage = global[gcv] || (global[gcv] = {});\n\n  if (!coverage[path] || coverage[path].hash !== hash) {\n    coverage[path] = coverageData;\n  }\n\n  var actualCoverage = coverage[path];\n\n  cov_j6hb4vjqv = function () {\n    return actualCoverage;\n  };\n\n  return actualCoverage;\n}\n\ncov_j6hb4vjqv();\nimport { generateRandomShips } from './game';\nimport shuffle from 'shuffle-array';\nexport class SeabattleBot {\n  async play(state, playerID) {\n    cov_j6hb4vjqv().f[0]++;\n    cov_j6hb4vjqv().s[0]++;\n\n    if (state.ctx.phase === 'setup') {\n      cov_j6hb4vjqv().b[0][0]++;\n      const shipPositions = (cov_j6hb4vjqv().s[1]++, generateRandomShips(parseInt(state.ctx.currentPlayer)));\n      cov_j6hb4vjqv().s[2]++;\n      return this.makeSetShipsMove(shipPositions, playerID);\n    } else {\n      cov_j6hb4vjqv().b[0][1]++;\n      // if this is the first turn for our AI, wait only 500ms.  Else 2500ms\n      const sleepMs = (cov_j6hb4vjqv().s[3]++, state.G.salvos.length === 0 ? (cov_j6hb4vjqv().b[1][0]++, 500) : (cov_j6hb4vjqv().b[1][1]++, 2500));\n      cov_j6hb4vjqv().s[4]++;\n      await sleep(sleepMs);\n      const cell = (cov_j6hb4vjqv().s[5]++, this.generateMove(playerID, state));\n      cov_j6hb4vjqv().s[6]++;\n      return this.makeSalvoMove(cell, playerID);\n    }\n  }\n\n  makeSetShipsMove(ships, playerID) {\n    cov_j6hb4vjqv().f[1]++;\n    cov_j6hb4vjqv().s[7]++;\n    return {\n      action: {\n        type: 'MAKE_MOVE',\n        payload: {\n          type: 'setShips',\n          args: [ships],\n          playerID\n        }\n      }\n    };\n  }\n\n  makeSalvoMove(cell, playerID) {\n    cov_j6hb4vjqv().f[2]++;\n    cov_j6hb4vjqv().s[8]++;\n    return {\n      action: {\n        type: 'MAKE_MOVE',\n        payload: {\n          type: 'salvo',\n          args: [cell.x, cell.y],\n          playerID\n        }\n      }\n    };\n  }\n\n  generateMove(playerID, state) {\n    cov_j6hb4vjqv().f[3]++;\n    const salvos = (cov_j6hb4vjqv().s[9]++, state.G.salvos.filter(salvo => {\n      cov_j6hb4vjqv().f[4]++;\n      cov_j6hb4vjqv().s[10]++;\n      return (cov_j6hb4vjqv().b[2][0]++, salvo.player === Number(playerID)) && (cov_j6hb4vjqv().b[2][1]++, salvo.hit === true) && (cov_j6hb4vjqv().b[2][2]++, typeof salvo.hitShip !== 'undefined');\n    }));\n    cov_j6hb4vjqv().s[11]++;\n\n    for (const salvo of salvos) {\n      cov_j6hb4vjqv().s[12]++;\n\n      // if we have already fired salvos, see if we've hit any ships that remain unsunk\n      if (!this.isShipSunk(state, salvo.hitShip)) {\n        cov_j6hb4vjqv().b[3][0]++;\n        const otherHitSalvos = (cov_j6hb4vjqv().s[13]++, this.getOtherSalvosHitShip(state, salvo.hitShip));\n        cov_j6hb4vjqv().s[14]++;\n\n        if (otherHitSalvos.length >= 2) {\n          cov_j6hb4vjqv().b[4][0]++;\n          cov_j6hb4vjqv().s[15]++;\n          // we have hit this ship at least twice, so we can make an intelligent move\n          return this.getNextShipFoundMove(state, otherHitSalvos);\n        } else {\n          cov_j6hb4vjqv().b[4][1]++;\n        } // no other salvos for the same ship were hit, so hit a random neighbor\n\n\n        cov_j6hb4vjqv().s[16]++;\n        return this.getRandomNeighbor(state, salvo);\n      } else {\n        cov_j6hb4vjqv().b[3][1]++;\n      }\n    } // generate a random move\n\n\n    cov_j6hb4vjqv().s[17]++;\n    return this.generateRandomMove(state);\n  }\n\n  getNextShipFoundMove(state, hitSalvos) {\n    cov_j6hb4vjqv().f[5]++;\n    const xMap = (cov_j6hb4vjqv().s[18]++, hitSalvos.map(salvo => {\n      cov_j6hb4vjqv().f[6]++;\n      cov_j6hb4vjqv().s[19]++;\n      return salvo.cell.x;\n    }));\n    const yMap = (cov_j6hb4vjqv().s[20]++, hitSalvos.map(salvo => {\n      cov_j6hb4vjqv().f[7]++;\n      cov_j6hb4vjqv().s[21]++;\n      return salvo.cell.y;\n    }));\n    const minPos = (cov_j6hb4vjqv().s[22]++, {\n      x: Math.min(...xMap),\n      y: Math.min(...yMap)\n    });\n    const maxPos = (cov_j6hb4vjqv().s[23]++, {\n      x: Math.max(...xMap),\n      y: Math.max(...yMap)\n    });\n    const direction = (cov_j6hb4vjqv().s[24]++, maxPos.x === minPos.x ? (cov_j6hb4vjqv().b[5][0]++, {\n      x: 0,\n      y: 1\n    }) : (cov_j6hb4vjqv().b[5][1]++, {\n      x: 1,\n      y: 0\n    }));\n    cov_j6hb4vjqv().s[25]++;\n    return this.anyValidMove(state, [{\n      x: minPos.x - direction.x,\n      y: minPos.y - direction.y\n    }, {\n      x: maxPos.x + direction.x,\n      y: maxPos.y + direction.y\n    }]);\n  }\n\n  isInBounds(x) {\n    cov_j6hb4vjqv().f[8]++;\n    cov_j6hb4vjqv().s[26]++;\n    return (cov_j6hb4vjqv().b[6][0]++, x >= 0) && (cov_j6hb4vjqv().b[6][1]++, x <= 9);\n  }\n\n  isValidMove(state, cell) {\n    cov_j6hb4vjqv().f[9]++;\n    cov_j6hb4vjqv().s[27]++;\n    return (cov_j6hb4vjqv().b[7][0]++, this.isInBounds(cell.x)) && (cov_j6hb4vjqv().b[7][1]++, this.isInBounds(cell.y)) && (cov_j6hb4vjqv().b[7][2]++, this.isUniqueMove(state, cell));\n  }\n\n  anyValidMove(state, moves) {\n    cov_j6hb4vjqv().f[10]++;\n    cov_j6hb4vjqv().s[28]++;\n    shuffle(moves); // ONLY source of randomness\n\n    cov_j6hb4vjqv().s[29]++;\n\n    for (const move of moves) {\n      cov_j6hb4vjqv().s[30]++;\n\n      if (this.isValidMove(state, move)) {\n        cov_j6hb4vjqv().b[8][0]++;\n        cov_j6hb4vjqv().s[31]++;\n        return move;\n      } else {\n        cov_j6hb4vjqv().b[8][1]++;\n      }\n    }\n\n    cov_j6hb4vjqv().s[32]++;\n    return null;\n  }\n\n  getRandomNeighbor(state, salvo) {\n    cov_j6hb4vjqv().f[11]++;\n    cov_j6hb4vjqv().s[33]++;\n    return this.anyValidMove(state, [{\n      x: salvo.cell.x - 1,\n      y: salvo.cell.y\n    }, {\n      x: salvo.cell.x,\n      y: salvo.cell.y - 1\n    }, {\n      x: salvo.cell.x + 1,\n      y: salvo.cell.y\n    }, {\n      x: salvo.cell.x,\n      y: salvo.cell.y + 1\n    }]);\n  }\n\n  getOtherSalvosHitShip(state, id) {\n    cov_j6hb4vjqv().f[12]++;\n    cov_j6hb4vjqv().s[34]++;\n    return state.G.salvos.filter(salvo => {\n      cov_j6hb4vjqv().f[13]++;\n      cov_j6hb4vjqv().s[35]++;\n      return salvo.hitShip === id;\n    });\n  }\n\n  isShipSunk(state, id) {\n    cov_j6hb4vjqv().f[14]++;\n    cov_j6hb4vjqv().s[36]++;\n    return state.G.ships.filter(ship => {\n      cov_j6hb4vjqv().f[15]++;\n      cov_j6hb4vjqv().s[37]++;\n      return ship.id === id;\n    })[0].sunk;\n  }\n\n  generateRandomMove(state) {\n    cov_j6hb4vjqv().f[16]++;\n    const allPossibleMoves = (cov_j6hb4vjqv().s[38]++, []);\n    cov_j6hb4vjqv().s[39]++;\n\n    for (let x = (cov_j6hb4vjqv().s[40]++, 0); x <= 9; x++) {\n      cov_j6hb4vjqv().s[41]++;\n\n      for (let y = (cov_j6hb4vjqv().s[42]++, 0); y <= 9; y++) {\n        cov_j6hb4vjqv().s[43]++;\n        allPossibleMoves.push({\n          x,\n          y\n        });\n      }\n    }\n\n    cov_j6hb4vjqv().s[44]++;\n    return this.anyValidMove(state, allPossibleMoves);\n  }\n\n  isUniqueMove(state, cell) {\n    cov_j6hb4vjqv().f[17]++;\n    const moves = (cov_j6hb4vjqv().s[45]++, state.G.salvos.filter(salvo => {\n      cov_j6hb4vjqv().f[18]++;\n      cov_j6hb4vjqv().s[46]++;\n      return (cov_j6hb4vjqv().b[9][0]++, salvo.player === parseInt(state.ctx.currentPlayer)) && (cov_j6hb4vjqv().b[9][1]++, salvo.cell.x === cell.x) && (cov_j6hb4vjqv().b[9][2]++, salvo.cell.y === cell.y);\n    }));\n    cov_j6hb4vjqv().s[47]++;\n    return moves.length === 0;\n  }\n\n}\nexport const config = (cov_j6hb4vjqv().s[48]++, {\n  bgioAI: () => {\n    cov_j6hb4vjqv().f[19]++;\n    cov_j6hb4vjqv().s[49]++;\n    return {\n      bot: SeabattleBot\n    };\n  }\n});\n\nfunction sleep(milliseconds) {\n  cov_j6hb4vjqv().f[20]++;\n  cov_j6hb4vjqv().s[50]++;\n  return new Promise(resolve => {\n    cov_j6hb4vjqv().f[21]++;\n    cov_j6hb4vjqv().s[51]++;\n    setTimeout(resolve, milliseconds);\n  });\n}\n\nexport default config;","map":{"version":3,"sources":["/home/j/Documents/FreeBoardGames.org/src/games/seabattle/ai.ts"],"names":["generateRandomShips","shuffle","SeabattleBot","play","state","playerID","ctx","phase","shipPositions","parseInt","currentPlayer","makeSetShipsMove","sleepMs","G","salvos","length","sleep","cell","generateMove","makeSalvoMove","ships","action","type","payload","args","x","y","filter","salvo","player","Number","hit","hitShip","isShipSunk","otherHitSalvos","getOtherSalvosHitShip","getNextShipFoundMove","getRandomNeighbor","generateRandomMove","hitSalvos","xMap","map","yMap","minPos","Math","min","maxPos","max","direction","anyValidMove","isInBounds","isValidMove","isUniqueMove","moves","move","id","ship","sunk","allPossibleMoves","push","config","bgioAI","bot","milliseconds","Promise","resolve","setTimeout"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","sourcesContent":["import { IAIConfig } from '../index';\nimport { ICell, IShip, ISalvo, generateRandomShips } from './game';\nimport shuffle from 'shuffle-array';\n\ninterface IAISalvo extends ISalvo {\n  up: boolean;\n  down: boolean;\n  left: boolean;\n  right: boolean;\n}\n\ninterface IPlayState {\n  G: any;\n  ctx: any;\n}\n\nexport class SeabattleBot {\n  async play(state: IPlayState, playerID: string) {\n    if (state.ctx.phase === 'setup') {\n      const shipPositions = generateRandomShips(parseInt(state.ctx.currentPlayer));\n      return this.makeSetShipsMove(shipPositions, playerID);\n    } else {\n      // if this is the first turn for our AI, wait only 500ms.  Else 2500ms\n      const sleepMs = state.G.salvos.length === 0 ? 500 : 2500;\n      await sleep(sleepMs);\n      const cell = this.generateMove(playerID, state);\n      return this.makeSalvoMove(cell, playerID);\n    }\n  }\n\n  makeSetShipsMove(ships: IShip[], playerID: string) {\n    return { action: { type: 'MAKE_MOVE', payload: { type: 'setShips', args: [ships], playerID } } };\n  }\n\n  makeSalvoMove(cell: ICell, playerID: string) {\n    return { action: { type: 'MAKE_MOVE', payload: { type: 'salvo', args: [cell.x, cell.y], playerID } } };\n  }\n\n  generateMove(playerID: string, state: IPlayState) {\n    const salvos = state.G.salvos.filter(\n      (salvo: ISalvo) =>\n        salvo.player === Number(playerID) && salvo.hit === true && typeof salvo.hitShip !== 'undefined',\n    );\n    for (const salvo of salvos) {\n      // if we have already fired salvos, see if we've hit any ships that remain unsunk\n      if (!this.isShipSunk(state, salvo.hitShip)) {\n        const otherHitSalvos = this.getOtherSalvosHitShip(state, salvo.hitShip);\n        if (otherHitSalvos.length >= 2) {\n          // we have hit this ship at least twice, so we can make an intelligent move\n          return this.getNextShipFoundMove(state, otherHitSalvos);\n        }\n        // no other salvos for the same ship were hit, so hit a random neighbor\n        return this.getRandomNeighbor(state, salvo);\n      }\n    }\n    // generate a random move\n    return this.generateRandomMove(state);\n  }\n\n  getNextShipFoundMove(state: IPlayState, hitSalvos: ISalvo[]): ICell {\n    const xMap = hitSalvos.map((salvo) => salvo.cell.x);\n    const yMap = hitSalvos.map((salvo) => salvo.cell.y);\n\n    const minPos = { x: Math.min(...xMap), y: Math.min(...yMap) };\n    const maxPos = { x: Math.max(...xMap), y: Math.max(...yMap) };\n    const direction = maxPos.x === minPos.x ? { x: 0, y: 1 } : { x: 1, y: 0 };\n    return this.anyValidMove(state, [\n      { x: minPos.x - direction.x, y: minPos.y - direction.y },\n      { x: maxPos.x + direction.x, y: maxPos.y + direction.y },\n    ]);\n  }\n\n  isInBounds(x: number) {\n    return x >= 0 && x <= 9;\n  }\n\n  isValidMove(state: IPlayState, cell: ICell) {\n    return this.isInBounds(cell.x) && this.isInBounds(cell.y) && this.isUniqueMove(state, cell);\n  }\n\n  anyValidMove(state: IPlayState, moves: ICell[]) {\n    shuffle(moves); // ONLY source of randomness\n    for (const move of moves) {\n      if (this.isValidMove(state, move)) {\n        return move;\n      }\n    }\n    return null;\n  }\n\n  getRandomNeighbor(state: IPlayState, salvo: ISalvo): ICell {\n    return this.anyValidMove(state, [\n      { x: salvo.cell.x - 1, y: salvo.cell.y },\n      { x: salvo.cell.x, y: salvo.cell.y - 1 },\n      { x: salvo.cell.x + 1, y: salvo.cell.y },\n      { x: salvo.cell.x, y: salvo.cell.y + 1 },\n    ]);\n  }\n\n  getOtherSalvosHitShip(state: IPlayState, id: string) {\n    return state.G.salvos.filter((salvo: ISalvo) => salvo.hitShip === id);\n  }\n\n  isShipSunk(state: IPlayState, id: string) {\n    return state.G.ships.filter((ship: IShip) => ship.id === id)[0].sunk;\n  }\n\n  generateRandomMove(state: IPlayState) {\n    const allPossibleMoves: ICell[] = [];\n    for (let x = 0; x <= 9; x++) {\n      for (let y = 0; y <= 9; y++) {\n        allPossibleMoves.push({ x, y });\n      }\n    }\n    return this.anyValidMove(state, allPossibleMoves);\n  }\n\n  isUniqueMove(state: IPlayState, cell: ICell) {\n    const moves = state.G.salvos.filter(\n      (salvo: ISalvo) =>\n        salvo.player === parseInt(state.ctx.currentPlayer) && salvo.cell.x === cell.x && salvo.cell.y === cell.y,\n    );\n    return moves.length === 0;\n  }\n}\n\nexport const config: IAIConfig = {\n  bgioAI: () => {\n    return {\n      bot: SeabattleBot,\n    };\n  },\n};\n\nfunction sleep(milliseconds: number) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, milliseconds);\n  });\n}\n\nexport default config;\n"]},"metadata":{},"sourceType":"module"}